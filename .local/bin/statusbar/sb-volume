#!/bin/sh
# Prints the current volume or ðŸ”‡ if muted. (Version con amixer/ALSA)

case $BLOCK_BUTTON in
    # Clic de en medio para silenciar
    2) amixer set Master toggle > /dev/null && pkill -RTMIN+10 dwmblocks ;;
    # Scroll para cambiar volumen
    4) amixer set Master 1%+ > /dev/null && pkill -RTMIN+10 dwmblocks ;;
    5) amixer set Master 1%- > /dev/null && pkill -RTMIN+10 dwmblocks ;;
    *) ;;
esac

# Obtener el estado de amixer
output=$(amixer get Master | tail -n1)

# Revisar si estÃ¡ silenciado
if echo "$output" | grep -q "\[off\]"; then
    echo ðŸ”‡
    exit
fi

# Extraer el porcentaje de volumen
vol=$(echo "$output" | awk -F'[][]' '{print $2}' | tr -d '%')

# La misma lÃ³gica para los iconos
if [ "$vol" -ge 70 ]; then
    icon="ðŸ”Š"
elif [ "$vol" -ge 30 ]; then
    icon="ðŸ”‰"
elif [ "$vol" -ge 1 ]; then
    icon="ðŸ”ˆ"
else
    icon="ðŸ”‡"
fi

echo "$icon$vol%"
